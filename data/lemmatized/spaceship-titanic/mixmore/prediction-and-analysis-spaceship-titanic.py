import os
for (dirname, _, filenames) in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import sklearn
_input1 = pd.read_csv('data/input/spaceship-titanic/train.csv')
_input0 = pd.read_csv('data/input/spaceship-titanic/test.csv')
_input2 = pd.read_csv('data/input/spaceship-titanic/sample_submission.csv')
_input1.head()
_input0.head()
_input2.head()
_input1.shape
_input1.info()
_input1.columns
_input1.tail()
print(_input1.HomePlanet.unique())
print(_input1.Cabin.unique())
print(_input1.Destination.unique())
_input1.nunique()
print('TRAIN SET MISSING VALUES:')
print(_input1.isna().sum())
print('')
print('TEST SET MISSING VALUES:')
print(_input0.isna().sum())
print(f'Duplicates in train set: {_input1.duplicated().sum()}, ({np.round(100 * _input1.duplicated().sum() / len(_input1), 1)}%)')
print('')
print(f'Duplicates in test set: {_input0.duplicated().sum()}, ({np.round(100 * _input0.duplicated().sum() / len(_input0), 1)}%)')
(fig, axes) = plt.subplots(1, 2, sharex=True, figsize=(20, 10))
sns.heatmap(ax=axes[0], yticklabels=False, data=_input1.isnull(), cbar=False, cmap='viridis')
sns.heatmap(ax=axes[1], yticklabels=False, data=_input0.isnull(), cbar=False, cmap='tab20c')
axes[0].set_title('Heatmap of missing values in training data')
axes[1].set_title('Heatmap of missing values in testing data')
import missingno
missingno.matrix(_input1)
missingno.matrix(_input0)
data_df = pd.concat([_input1, _input0], axis=0)
data_df
idCol = _input0.PassengerId.to_numpy()
_input1 = _input1.set_index('PassengerId', inplace=False)
_input0 = _input0.set_index('PassengerId', inplace=False)
from sklearn.impute import SimpleImputer
imputer = SimpleImputer(missing_values=np.nan, strategy='most_frequent')
_input1 = pd.DataFrame(imputer.fit_transform(_input1), columns=_input1.columns, index=_input1.index)
_input0 = pd.DataFrame(imputer.fit_transform(_input0), columns=_input0.columns, index=_input0.index)
_input1 = _input1.reset_index(drop=True)
_input0 = _input0.reset_index(drop=True)
missingno.matrix(_input1)
missingno.matrix(_input0)
plt.figure(figsize=(17, 8))
plt.plot(_input1.isna().sum() / len(_input1) * 100)
plt.plot(_input0.isna().sum() / len(_input1) * 100)
plt.legend(['train data', 'test data'])
plt.xlabel('Columns')
plt.ylabel('% of Null')
plt.figure(figsize=(6, 6))
_input1['Transported'].value_counts().plot.pie(explode=[0.1, 0.1], autopct='%1.1f%%', shadow=True, textprops={'fontsize': 16}).set_title('Target distribution')
plt.figure(figsize=(10, 4))
sns.histplot(data=_input1, x='Age', hue='Transported', binwidth=1, kde=True)
plt.title('Age distribution')
plt.xlabel('Age (years)')
exp_feats = ['RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck']
fig = plt.figure(figsize=(10, 20))
for (i, var_name) in enumerate(exp_feats):
    ax = fig.add_subplot(5, 2, 2 * i + 1)
    sns.histplot(data=_input1, x=var_name, axes=ax, bins=30, kde=False, hue='Transported')
    ax.set_title(var_name)
    ax = fig.add_subplot(5, 2, 2 * i + 2)
    sns.histplot(data=_input1, x=var_name, axes=ax, bins=30, kde=True, hue='Transported')
    plt.ylim([0, 100])
    ax.set_title(var_name)
fig.tight_layout()
cat_feats = ['HomePlanet', 'CryoSleep', 'Destination', 'VIP']
fig = plt.figure(figsize=(10, 16))
for (i, var_name) in enumerate(cat_feats):
    ax = fig.add_subplot(4, 1, i + 1)
    sns.countplot(data=_input1, x=var_name, axes=ax, hue='Transported')
    ax.set_title(var_name)
fig.tight_layout()
_input1['Expenditure'] = _input1[exp_feats].sum(axis=1)
_input1['No_spending'] = (_input1['Expenditure'] == 0).astype(int)
_input0['Expenditure'] = _input0[exp_feats].sum(axis=1)
_input0['No_spending'] = (_input0['Expenditure'] == 0).astype(int)
fig = plt.figure(figsize=(12, 4))
plt.subplot(1, 2, 1)
sns.histplot(data=_input1, x='Expenditure', hue='Transported', bins=200)
plt.title('Total expenditure (truncated)')
plt.ylim([0, 200])
plt.xlim([0, 20000])
plt.subplot(1, 2, 2)
sns.countplot(data=_input1, x='No_spending', hue='Transported')
plt.title('No spending indicator')
fig.tight_layout()
_input1.Transported = _input1.Transported.astype('int')
_input1.VIP = _input1.VIP.astype('int')
_input1.CryoSleep = _input1.CryoSleep.astype('int')
_input1 = _input1.drop(columns=['Cabin', 'Name'], inplace=False)
_input0 = _input0.drop(columns=['Cabin', 'Name'], inplace=False)
_input1.head()
_input1 = pd.get_dummies(_input1, columns=['HomePlanet', 'CryoSleep', 'Destination'])
_input0 = pd.get_dummies(_input0, columns=['HomePlanet', 'CryoSleep', 'Destination'])
_input1.head()
y_Train = _input1.pop('Transported').to_numpy()
x_Train = _input1.to_numpy()
x_Test = _input0.to_numpy()
y_Test = _input0.to_numpy()
(x_Train.shape, y_Train.shape, x_Test.shape, y_Test.shape)
from sklearn.neighbors import KNeighborsClassifier
knnClassifier = KNeighborsClassifier(3)
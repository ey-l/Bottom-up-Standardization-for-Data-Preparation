import numpy as np
import pandas as pd
import os
for (dirname, _, filenames) in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))
import pandas as pd
import numpy as np
from matplotlib import pyplot as plt
import seaborn as sns
import plotly.express as px
import math
_input1 = pd.read_csv('_data/input/house-prices-advanced-regression-techniques/train.csv')
_input1
_input1.shape
_input1.isnull().sum()
_input1['LotFrontage'] = _input1.groupby('Neighborhood')['LotFrontage'].transform(lambda x: x.fillna(x.median()))
print(_input1['MSSubClass'].nunique())
_input1['MSSubClass'].value_counts()
print(_input1['MSZoning'].nunique())
print(_input1['MSZoning'].value_counts())
print(_input1['FireplaceQu'].nunique())
print(_input1['FireplaceQu'].value_counts())
_input1['Alley'] = _input1['Alley'].fillna('No alley')
_input1['BsmtQual'] = _input1['BsmtQual'].fillna('No Basement')
_input1['BsmtCond'] = _input1['BsmtCond'].fillna('No Basement')
_input1['BsmtExposure'] = _input1['BsmtExposure'].fillna('No Basement')
_input1['BsmtFinType1'] = _input1['BsmtFinType1'].fillna('No Basement')
_input1['BsmtFinType2'] = _input1['BsmtFinType2'].fillna('No Basement')
_input1['FireplaceQu'] = _input1['FireplaceQu'].fillna('No Fireplace')
_input1['GarageType'] = _input1['GarageType'].fillna('No Garage')
_input1['GarageFinish'] = _input1['GarageFinish'].fillna('No Garage')
_input1['GarageQual'] = _input1['GarageQual'].fillna('No Garage')
_input1['GarageQual'] = _input1['GarageQual'].fillna('No Garage')
_input1['PoolQC'] = _input1['PoolQC'].fillna('No pool')
_input1['Fence'] = _input1['Fence'].fillna('No fence')
_input1['MiscFeature'] = _input1['MiscFeature'].fillna('None')
_input1
_input1['Neighborhood'].value_counts()
_input1.isnull().sum()
print(_input1['LotShape'].nunique())
print(_input1['LotShape'].value_counts())
print(_input1['LandContour'].nunique())
print(_input1['LandContour'].value_counts())
print(_input1['Utilities'].nunique())
print(_input1['Utilities'].value_counts())
print(_input1['LotConfig'].nunique())
print(_input1['LotConfig'].value_counts())
print(_input1['PoolArea'].nunique())
print(_input1['PoolArea'].value_counts())
print(_input1['Alley'].nunique())
print(_input1['Alley'].value_counts())
_input1.info()
_input1
_input1.info()
LotShape = pd.get_dummies(_input1['LotShape'])
Neighborhood = pd.get_dummies(_input1['Neighborhood'])
print(Neighborhood.columns)
RoofStyle = pd.get_dummies(_input1['RoofStyle'])
HouseStyle = pd.get_dummies(_input1['HouseStyle'])
BldgType = pd.get_dummies(_input1['BldgType'])
Condition2 = pd.get_dummies(_input1['Condition2'])
Condition1 = pd.get_dummies(_input1['Condition1'])
Neighborhood = pd.get_dummies(_input1['Neighborhood'])
Utilities = pd.get_dummies(_input1['Utilities'])
LandContour = pd.get_dummies(_input1['LandContour'])
Street = pd.get_dummies(_input1['Street'])
ExterCond = pd.get_dummies(_input1['ExterCond'])
ExterQual = pd.get_dummies(_input1['ExterQual'])
MasVnrType = pd.get_dummies(_input1['MasVnrType'])
Exterior2nd = pd.get_dummies(_input1['Exterior2nd'])
Exterior1st = pd.get_dummies(_input1['Exterior1st'])
MSZoning = pd.get_dummies(_input1['MSZoning'])
BsmtFinType2 = pd.get_dummies(_input1['BsmtFinType2'])
BsmtFinType1 = pd.get_dummies(_input1['BsmtFinType1'])
BsmtExposure = pd.get_dummies(_input1['BsmtExposure'])
BsmtCond = pd.get_dummies(_input1['BsmtCond'])
BsmtQual = pd.get_dummies(_input1['BsmtQual'])
Foundation = pd.get_dummies(_input1['Foundation'])
Functional = pd.get_dummies(_input1['Functional'])
Electrical = pd.get_dummies(_input1['Electrical'])
CentralAir = pd.get_dummies(_input1['CentralAir'])
KitchenQual = pd.get_dummies(_input1['KitchenQual'])
HeatingQC = pd.get_dummies(_input1['HeatingQC'])
Heating = pd.get_dummies(_input1['Heating'])
LotConfig = pd.get_dummies(_input1['LotConfig'])
LandSlope = pd.get_dummies(_input1['LandSlope'])
SaleCondition = pd.get_dummies(_input1['SaleCondition'])
SaleType = pd.get_dummies(_input1['SaleType'])
PavedDrive = pd.get_dummies(_input1['PavedDrive'])
GarageCond = pd.get_dummies(_input1['GarageCond'])
GarageQual = pd.get_dummies(_input1['GarageQual'])
GarageFinish = pd.get_dummies(_input1['GarageFinish'])
GarageType = pd.get_dummies(_input1['GarageType'])
Alley = pd.get_dummies(_input1['Alley'])
FireplaceQu = pd.get_dummies(_input1['FireplaceQu'])
PoolQC = pd.get_dummies(_input1['PoolQC'])
Fence = pd.get_dummies(_input1['Fence'])
MiscFeature = pd.get_dummies(_input1['MiscFeature'])
_input1 = pd.concat([_input1, Neighborhood, MSZoning, Street, LotShape, Exterior1st, Exterior2nd, Heating, Alley, GarageQual, Utilities, Electrical, LandContour, RoofStyle, FireplaceQu, Condition2, PoolQC, Fence, MiscFeature, BldgType, Condition1, Neighborhood, ExterCond, ExterQual, MasVnrType, BsmtFinType2, BsmtFinType1, BsmtExposure, BsmtCond, BsmtQual, Foundation, Functional, CentralAir, KitchenQual, HeatingQC, GarageCond, GarageFinish, GarageType, LotConfig, LandSlope, SaleCondition, SaleType, PavedDrive], axis=1)
_input1 = _input1.drop(['MSZoning', 'Street', 'LotShape', 'LandContour', 'Utilities', 'RoofMatl', 'RoofStyle', 'HouseStyle', 'BldgType', 'Condition2', 'Condition1', 'Neighborhood', 'ExterCond', 'ExterQual', 'MasVnrType', 'Exterior2nd', 'Exterior1st', 'BsmtFinType2', 'BsmtFinType1', 'FireplaceQu', 'PoolQC', 'Fence', 'MiscFeature', 'Alley', 'BsmtExposure', 'BsmtCond', 'BsmtQual', 'Foundation', 'Functional', 'Electrical', 'CentralAir', 'KitchenQual', 'HeatingQC', 'Heating', 'GarageCond', 'GarageQual', 'GarageFinish', 'GarageType', 'LotConfig', 'LandSlope', 'SaleCondition', 'SaleType', 'PavedDrive'], axis=1, inplace=False)
_input1
x = _input1.drop('SalePrice', axis=1)
y = _input1['SalePrice']
from sklearn.impute import SimpleImputer
imputer = SimpleImputer(missing_values=np.nan, strategy='median', verbose=0)
import os
for (dirname, _, filenames) in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))
from sklearn.ensemble import RandomForestRegressor
import xgboost as xgb
import lightgbm as lgb
import pandas as pd
import numpy as np
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import r2_score
import warnings
warnings.simplefilter('ignore')
_input1 = pd.read_csv('_data/input/house-prices-advanced-regression-techniques/train.csv')
_input0 = pd.read_csv('_data/input/house-prices-advanced-regression-techniques/test.csv')
_input1
le = LabelEncoder()
_input1['MSZoning'] = le.fit_transform(_input1['MSZoning'])
_input1['Street'] = le.fit_transform(_input1['Street'])
_input1['LotShape'] = le.fit_transform(_input1['LotShape'])
_input1['LandContour'] = le.fit_transform(_input1['LandContour'])
_input1['Utilities'] = le.fit_transform(_input1['Utilities'])
_input1['PoolQC'] = le.fit_transform(_input1['PoolQC'])
_input1['Fence'] = le.fit_transform(_input1['Fence'])
_input1['MiscFeature'] = le.fit_transform(_input1['MiscFeature'])
_input1['SaleType'] = le.fit_transform(_input1['SaleType'])
_input1['SaleCondition'] = le.fit_transform(_input1['SaleCondition'])
_input1['MSZoning'] = le.fit_transform(_input1['MSZoning'])
_input1['Street'] = le.fit_transform(_input1['Street'])
_input1['Alley'] = le.fit_transform(_input1['Alley'])
_input1['LotShape'] = le.fit_transform(_input1['LotShape'])
_input1['LotConfig'] = le.fit_transform(_input1['LotConfig'])
_input1['LandSlope'] = le.fit_transform(_input1['LandSlope'])
_input1['Neighborhood'] = le.fit_transform(_input1['Neighborhood'])
_input1['Condition1'] = le.fit_transform(_input1['Condition1'])
_input1['Condition2'] = le.fit_transform(_input1['Condition2'])
_input1['BldgType'] = le.fit_transform(_input1['BldgType'])
_input1['HouseStyle'] = le.fit_transform(_input1['HouseStyle'])
_input1['OverallQual'] = le.fit_transform(_input1['OverallQual'])
_input1['RoofStyle'] = le.fit_transform(_input1['RoofStyle'])
_input1['RoofMatl'] = le.fit_transform(_input1['RoofMatl'])
_input1['Exterior1st'] = le.fit_transform(_input1['Exterior1st'])
_input1['Exterior2nd'] = le.fit_transform(_input1['Exterior2nd'])
_input1[['MasVnrType']].astype(str)
_input1['MasVnrType'] = le.fit_transform(_input1['MasVnrType'])
_input1['ExterQual'] = le.fit_transform(_input1['ExterQual'])
_input1['ExterCond'] = le.fit_transform(_input1['ExterCond'])
_input1['Foundation'] = le.fit_transform(_input1['Foundation'])
_input1['BsmtQual'] = le.fit_transform(_input1['BsmtQual'])
_input1['BsmtCond'] = le.fit_transform(_input1['BsmtCond'])
_input1['BsmtExposure'] = le.fit_transform(_input1['BsmtExposure'])
_input1['PavedDrive'] = le.fit_transform(_input1['PavedDrive'])
_input1['BsmtFinType1'] = le.fit_transform(_input1['BsmtFinType1'])
_input1['GarageFinish'] = le.fit_transform(_input1['GarageFinish'])
_input1['Functional'] = le.fit_transform(_input1['Functional'])
_input1['KitchenQual'] = le.fit_transform(_input1['KitchenQual'])
_input1['GarageQual'] = le.fit_transform(_input1['GarageQual'])
_input1['GarageCond'] = le.fit_transform(_input1['GarageCond'])
_input1['BsmtCond'] = le.fit_transform(_input1['BsmtCond'])
_input1['BsmtFinType1'] = le.fit_transform(_input1['BsmtFinType1'])
_input1['BsmtFinType2'] = le.fit_transform(_input1['BsmtFinType2'])
_input1['Heating'] = le.fit_transform(_input1['Heating'])
_input1['BsmtQual'] = le.fit_transform(_input1['BsmtQual'])
_input1['Electrical'] = le.fit_transform(_input1['Electrical'])
_input1['HeatingQC'] = le.fit_transform(_input1['HeatingQC'])
_input1['GarageFinish'] = le.fit_transform(_input1['GarageFinish'])
_input1['GarageType'] = le.fit_transform(_input1['GarageType'])
_input1['CentralAir'] = le.fit_transform(_input1['CentralAir'])
_input1['FireplaceQu'] = le.fit_transform(_input1['FireplaceQu'])
_input0['MSZoning'] = le.fit_transform(_input0['MSZoning'])
_input0['Street'] = le.fit_transform(_input0['Street'])
_input0['LotShape'] = le.fit_transform(_input0['LotShape'])
_input0['LandContour'] = le.fit_transform(_input0['LandContour'])
_input0['Utilities'] = le.fit_transform(_input0['Utilities'])
_input0['PoolQC'] = le.fit_transform(_input0['PoolQC'])
_input0['Fence'] = le.fit_transform(_input0['Fence'])
_input0['MiscFeature'] = le.fit_transform(_input0['MiscFeature'])
_input0['SaleType'] = le.fit_transform(_input0['SaleType'])
_input0['SaleCondition'] = le.fit_transform(_input0['SaleCondition'])
_input0['MSZoning'] = le.fit_transform(_input0['MSZoning'])
_input0['Street'] = le.fit_transform(_input0['Street'])
_input0['Alley'] = le.fit_transform(_input0['Alley'])
_input0['LotShape'] = le.fit_transform(_input0['LotShape'])
_input0['LotConfig'] = le.fit_transform(_input0['LotConfig'])
_input0['LandSlope'] = le.fit_transform(_input0['LandSlope'])
_input0['Neighborhood'] = le.fit_transform(_input0['Neighborhood'])
_input0['Condition1'] = le.fit_transform(_input0['Condition1'])
_input0['Condition2'] = le.fit_transform(_input0['Condition2'])
_input0['BldgType'] = le.fit_transform(_input0['BldgType'])
_input0['HouseStyle'] = le.fit_transform(_input0['HouseStyle'])
_input0['OverallQual'] = le.fit_transform(_input0['OverallQual'])
_input0['RoofStyle'] = le.fit_transform(_input0['RoofStyle'])
_input0['RoofMatl'] = le.fit_transform(_input0['RoofMatl'])
_input0['Exterior1st'] = le.fit_transform(_input0['Exterior1st'])
_input0['Exterior2nd'] = le.fit_transform(_input0['Exterior2nd'])
_input0[['MasVnrType']].astype(str)
_input0['MasVnrType'] = le.fit_transform(_input0['MasVnrType'])
_input0['ExterQual'] = le.fit_transform(_input0['ExterQual'])
_input0['ExterCond'] = le.fit_transform(_input0['ExterCond'])
_input0['Foundation'] = le.fit_transform(_input0['Foundation'])
_input0['BsmtQual'] = le.fit_transform(_input0['BsmtQual'])
_input0['BsmtCond'] = le.fit_transform(_input0['BsmtCond'])
_input0['BsmtExposure'] = le.fit_transform(_input0['BsmtExposure'])
_input0['PavedDrive'] = le.fit_transform(_input0['PavedDrive'])
_input0['BsmtFinType1'] = le.fit_transform(_input0['BsmtFinType1'])
_input0['GarageFinish'] = le.fit_transform(_input0['GarageFinish'])
_input0['Functional'] = le.fit_transform(_input0['Functional'])
_input0['KitchenQual'] = le.fit_transform(_input0['KitchenQual'])
_input0['GarageQual'] = le.fit_transform(_input0['GarageQual'])
_input0['GarageCond'] = le.fit_transform(_input0['GarageCond'])
_input0['BsmtCond'] = le.fit_transform(_input0['BsmtCond'])
_input0['BsmtFinType1'] = le.fit_transform(_input0['BsmtFinType1'])
_input0['BsmtFinType2'] = le.fit_transform(_input0['BsmtFinType2'])
_input0['Heating'] = le.fit_transform(_input0['Heating'])
_input0['BsmtQual'] = le.fit_transform(_input0['BsmtQual'])
_input0['Electrical'] = le.fit_transform(_input0['Electrical'])
_input0['HeatingQC'] = le.fit_transform(_input0['HeatingQC'])
_input0['GarageFinish'] = le.fit_transform(_input0['GarageFinish'])
_input0['GarageType'] = le.fit_transform(_input0['GarageType'])
_input0['CentralAir'] = le.fit_transform(_input0['CentralAir'])
_input0['FireplaceQu'] = le.fit_transform(_input0['FireplaceQu'])
_input1 = _input1.fillna(_input1.mean())
_input1
_input1.corr()
x_train_p = _input1.iloc[0:, 1:80]
y_train_p = _input1.iloc[0:, -1]
x_train = x_train_p.to_numpy()
y_train = y_train_p.to_numpy()
x_test_p = _input0.iloc[0:, 1:]
x_test = x_test_p.to_numpy()
x_train_p
xgbm = xgb.XGBRegressor(max_depth=10)
import pandas as pd
import numpy as np
_input1 = pd.read_csv('data/input/titanic/train.csv')
_input0 = pd.read_csv('data/input/titanic/test.csv')
_input1.head()
_input1 = _input1.drop(['Name'], axis=1, inplace=False)
_input1.head()
_input1.columns
_input1.index
_input2 = pd.read_csv('data/input/titanic/gender_submission.csv')
_input2.head()
_input1.head()
_input0.head()
_input0 = _input0.drop(['Name'], axis=1, inplace=False)
_input0.head()
_input1.isnull().sum()
_input1.index
_input0.isnull().sum()
_input1 = _input1.drop(['Cabin'], axis=1, inplace=False)
_input0 = _input0.drop(['Cabin'], axis=1, inplace=False)
_input0 = _input0.drop(['Ticket'], axis=1, inplace=False)
_input1 = _input1.drop(['Ticket'], axis=1, inplace=False)
_input1 = _input1.drop(['PassengerId'], axis=1, inplace=False)
_input0 = _input0.drop(['PassengerId'], axis=1, inplace=False)
_input0.head()
_input1.head()
import seaborn as sns
sns.countplot(x='Survived', hue='Sex', data=_input1)
sns.countplot(x='Survived', hue='Parch', data=_input1)
sns.countplot(x='Survived', hue='SibSp', data=_input1)
sns.countplot(x='Survived', hue='Pclass', data=_input1)
_input1.isnull().sum()
_input0.isnull().sum()
_input1['Age'].mean()
_input1['Age'] = _input1['Age'].fillna(_input1['Age'].mean(), inplace=False)
_input0['Age'] = _input0['Age'].fillna(_input0['Age'].mean(), inplace=False)
_input0['Fare'] = _input0['Fare'].fillna(_input0['Fare'].mean(), inplace=False)
_input1.dropna()
_input0.isnull().sum()
_input1.columns
_input1.head()
_input0.head()
Pclass = pd.get_dummies(_input1['Pclass'], drop_first=True)
Pclass1 = pd.get_dummies(_input0['Pclass'], drop_first=True)
Sex = pd.get_dummies(_input1['Sex'], drop_first=True)
Sex1 = pd.get_dummies(_input0['Sex'], drop_first=True)
Embarked = pd.get_dummies(_input1['Embarked'], drop_first=True)
Embarked1 = pd.get_dummies(_input0['Embarked'], drop_first=True)
_input1 = pd.concat([_input1, Pclass, Sex, Embarked], axis=1)
_input0 = pd.concat([_input0, Pclass1, Sex1, Embarked1], axis=1)
_input1 = _input1.drop(['Sex', 'Embarked', 'Pclass'], axis=1, inplace=False)
_input0 = _input0.drop(['Sex', 'Embarked', 'Pclass'], axis=1, inplace=False)
_input1.head()
_input0.head()
_input2.head()
y = _input1['Survived']
y.head()
X = _input1.drop('Survived', axis=1)
X.head()
from sklearn.preprocessing import StandardScaler
sc = StandardScaler()
X = sc.fit_transform(X)
_input0 = sc.fit_transform(_input0)
import keras
from keras.models import Sequential
from keras.layers import Dense
model = Sequential()
model.add(Dense(9, kernel_initializer='uniform', activation='relu', input_dim=9))
model.add(Dense(9, kernel_initializer='uniform', activation='relu'))
model.add(Dense(5, kernel_initializer='uniform', activation='relu'))
model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
model.summary()
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
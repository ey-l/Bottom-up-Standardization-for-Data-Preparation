import pandas as pd
import numpy as np
import missingno as mno
import seaborn as sns
import matplotlib.pyplot as plt

import warnings
warnings.filterwarnings('ignore')
data = pd.read_csv('data/input/uciml_pima-indians-diabetes-database/diabetes.csv')
data.head()
print('The shape of the data is ', data.shape)
data.info()
data.describe().transpose()
data.isna().sum()
data.duplicated().sum()
data_copy = data.copy(deep=True)
data_copy[['Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI']] = data_copy[['Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI']].replace(0, np.NaN)
print(data_copy.isnull().sum())
mno.matrix(data_copy, figsize=(20, 6))
round(data_copy.isnull().sum() / len(data_copy) * 100, 2)
df = data_copy
(fig, ax) = plt.subplots(4, 2, figsize=(16, 16))
sns.distplot(df.Age, bins=20, ax=ax[0, 0])
sns.distplot(df.Pregnancies, bins=20, ax=ax[0, 1])
sns.distplot(df.Glucose, bins=20, ax=ax[1, 0])
sns.distplot(df.BloodPressure, bins=20, ax=ax[1, 1])
sns.distplot(df.SkinThickness, bins=20, ax=ax[2, 0])
sns.distplot(df.Insulin, bins=20, ax=ax[2, 1])
sns.distplot(df.DiabetesPedigreeFunction, bins=20, ax=ax[3, 0])
sns.distplot(df.BMI, bins=20, ax=ax[3, 1])
df.skew()
df['BMI'].fillna(df['BMI'].median(), inplace=True)
df['Glucose'].fillna(df['Glucose'].mean(), inplace=True)
df['BloodPressure'].fillna(df['BloodPressure'].mean(), inplace=True)
df['SkinThickness'].fillna(df['SkinThickness'].median(), inplace=True)
df['Insulin'].fillna(df['Insulin'].median(), inplace=True)
df.corr()
plt.figure(figsize=(12, 10))
sns.heatmap(df.corr(), annot=True)
data_copy.corrwith(data_copy['Outcome'], axis=0).sort_values(ascending=False)
sns.pairplot(df, hue='Outcome')

def distplot(col_name):
    plt.figure()
    ax = sns.distplot(df[col_name][df.Outcome == 1], color='darkturquoise', rug=True)
    sns.distplot(df[col_name][df.Outcome == 0], color='lightcoral', rug=True)
    plt.legend(['Diabetes', 'No Diabetes'])
sns.countplot(x='Pregnancies', hue='Outcome', data=df)
distplot('Pregnancies')
distplot('Glucose')
sns.countplot(x='BloodPressure', hue='Outcome', data=df)
distplot('BloodPressure')
sns.countplot(x='SkinThickness', hue='Outcome', data=df)
distplot('SkinThickness')
distplot('Insulin')
distplot('BMI')
distplot('DiabetesPedigreeFunction')
sns.countplot(x='Age', hue='Outcome', data=df)
distplot('Age')
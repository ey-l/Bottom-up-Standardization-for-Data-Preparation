import numpy as np
import pandas as pd
train = pd.read_csv('data/input/spaceship-titanic/train.csv')
train.head()
train.shape
train.info()
train.drop(['RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck', 'Name'], axis=1, inplace=True)
train.head()
train.isnull().sum()
train.replace('-', 'nan')
train.replace('na', 'nan')
train.isnull().sum()
train['HomePlanet'].fillna(train['HomePlanet'].mode()[0], inplace=True)
train['CryoSleep'].fillna(train['CryoSleep'].mode()[0], inplace=True)
train[['Deck', 'Num', 'Side']] = train['Cabin'].str.split('/', expand=True)
train = train.drop(['Cabin'], axis=1)
train.head()
train['Deck'].fillna(train['Deck'].mode()[0], inplace=True)
train['Num'].fillna(train['Num'].mode()[0], inplace=True)
train['Num'] = train['Num'].astype(int)
train['Side'].fillna(train['Side'].mode()[0], inplace=True)
train['Destination'].fillna(train['Destination'].mode()[0], inplace=True)
train['Age'].mean()
train['Age'].median()
train['Age'].fillna(train['Age'].mean(), inplace=True)
train['VIP'].fillna(train['VIP'].mode()[0], inplace=True)
train.isnull().sum()
train.duplicated().sum()
train.skew()
train['Num'] = np.sqrt(train['Num'])
train['Num'].skew()
train['VIP'].replace({True: 1, False: 0}, inplace=True)
train['CryoSleep'].replace({True: 1, False: 0}, inplace=True)
train['HomePlanet'].unique()
train['HomePlanet'].replace({'Europa': 0, 'Earth': 1, 'Mars': 2}, inplace=True)
train['Destination'].unique()
train['Destination'].replace({'TRAPPIST-1e': 0, 'PSO J318.5-22': 1, '55 Cancri e': 2}, inplace=True)
train['Side'].unique()
train['Side'].replace({'P': 1, 'S': 0}, inplace=True)
train['Deck'].unique()
train['Deck'].replace({'A': 0, 'B': 1, 'C': 2, 'D': 3, 'E': 4, 'F': 5, 'G': 6, 'T': 7}, inplace=True)
train.head()
train.corr()
train.drop(['VIP', 'Num'], axis=1, inplace=True)
train.head()
x_train = train.drop('Transported', axis=1)
y_train = train['Transported']
x_train
y_train
test = pd.read_csv('data/input/spaceship-titanic/test.csv')
test.head()
test.shape
test.info()
test.drop(['RoomService', 'FoodCourt', 'ShoppingMall', 'Spa', 'VRDeck', 'Name', 'VIP'], axis=1, inplace=True)
test.head()
test.isnull().sum()
test.replace('-', 'nan')
test.replace('na', 'nan')
test.isnull().sum()
test['HomePlanet'].fillna(test['HomePlanet'].mode()[0], inplace=True)
test['CryoSleep'].fillna(test['CryoSleep'].mode()[0], inplace=True)
test[['Deck', 'Num', 'Side']] = test['Cabin'].str.split('/', expand=True)
test.drop(['Cabin'], axis=1, inplace=True)
test.head()
test['Deck'].fillna(test['Deck'].mode()[0], inplace=True)
test.drop(['Num'], axis=1, inplace=True)
test['Side'].fillna(test['Side'].mode()[0], inplace=True)
test['Destination'].fillna(test['Destination'].mode()[0], inplace=True)
test['Age'].mean()
test['Age'].median()
test['Age'].fillna(test['Age'].mean(), inplace=True)
test.skew()
test['CryoSleep'].replace({True: 1, False: 0}, inplace=True)
test.head()
test['HomePlanet'].unique()
test['HomePlanet'].replace({'Europa': 0, 'Earth': 1, 'Mars': 2}, inplace=True)
test['Destination'].unique()
test['Destination'].replace({'TRAPPIST-1e': 0, 'PSO J318.5-22': 1, '55 Cancri e': 2}, inplace=True)
test['Deck'].unique()
test['Deck'].replace({'A': 0, 'B': 1, 'C': 2, 'D': 3, 'E': 4, 'F': 5, 'G': 6, 'T': 7}, inplace=True)
test['Side'].unique()
test['Side'].replace({'P': 1, 'S': 0}, inplace=True)
test.head()
test.isnull().sum()
x_test = test.iloc[:, 0:]
from sklearn.preprocessing import StandardScaler
sc_x = StandardScaler()
x_train = sc_x.fit_transform(x_train)
x_test = sc_x.transform(x_test)
from sklearn.svm import SVC
model = SVC(kernel='rbf', random_state=0)
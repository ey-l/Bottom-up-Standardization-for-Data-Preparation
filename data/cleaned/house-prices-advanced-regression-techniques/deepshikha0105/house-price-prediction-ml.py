import numpy as np
import pandas as pd
import os
for (dirname, _, filenames) in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))
import pandas as pd
import numpy as np
from matplotlib import pyplot as plt
import seaborn as sns
import plotly.express as px
import math
train = pd.read_csv('_data/input/house-prices-advanced-regression-techniques/train.csv')
train
train.shape
train.isnull().sum()
train['LotFrontage'] = train.groupby('Neighborhood')['LotFrontage'].transform(lambda x: x.fillna(x.median()))
print(train['MSSubClass'].nunique())
train['MSSubClass'].value_counts()
print(train['MSZoning'].nunique())
print(train['MSZoning'].value_counts())
print(train['FireplaceQu'].nunique())
print(train['FireplaceQu'].value_counts())
train['Alley'] = train['Alley'].fillna('No alley')
train['BsmtQual'] = train['BsmtQual'].fillna('No Basement')
train['BsmtCond'] = train['BsmtCond'].fillna('No Basement')
train['BsmtExposure'] = train['BsmtExposure'].fillna('No Basement')
train['BsmtFinType1'] = train['BsmtFinType1'].fillna('No Basement')
train['BsmtFinType2'] = train['BsmtFinType2'].fillna('No Basement')
train['FireplaceQu'] = train['FireplaceQu'].fillna('No Fireplace')
train['GarageType'] = train['GarageType'].fillna('No Garage')
train['GarageFinish'] = train['GarageFinish'].fillna('No Garage')
train['GarageQual'] = train['GarageQual'].fillna('No Garage')
train['GarageQual'] = train['GarageQual'].fillna('No Garage')
train['PoolQC'] = train['PoolQC'].fillna('No pool')
train['Fence'] = train['Fence'].fillna('No fence')
train['MiscFeature'] = train['MiscFeature'].fillna('None')
train
train['Neighborhood'].value_counts()
train.isnull().sum()
print(train['LotShape'].nunique())
print(train['LotShape'].value_counts())
print(train['LandContour'].nunique())
print(train['LandContour'].value_counts())
print(train['Utilities'].nunique())
print(train['Utilities'].value_counts())
print(train['LotConfig'].nunique())
print(train['LotConfig'].value_counts())
print(train['PoolArea'].nunique())
print(train['PoolArea'].value_counts())
print(train['Alley'].nunique())
print(train['Alley'].value_counts())
train.info()
train
train.info()
LotShape = pd.get_dummies(train['LotShape'])
Neighborhood = pd.get_dummies(train['Neighborhood'])
print(Neighborhood.columns)
RoofStyle = pd.get_dummies(train['RoofStyle'])
HouseStyle = pd.get_dummies(train['HouseStyle'])
BldgType = pd.get_dummies(train['BldgType'])
Condition2 = pd.get_dummies(train['Condition2'])
Condition1 = pd.get_dummies(train['Condition1'])
Neighborhood = pd.get_dummies(train['Neighborhood'])
Utilities = pd.get_dummies(train['Utilities'])
LandContour = pd.get_dummies(train['LandContour'])
Street = pd.get_dummies(train['Street'])
ExterCond = pd.get_dummies(train['ExterCond'])
ExterQual = pd.get_dummies(train['ExterQual'])
MasVnrType = pd.get_dummies(train['MasVnrType'])
Exterior2nd = pd.get_dummies(train['Exterior2nd'])
Exterior1st = pd.get_dummies(train['Exterior1st'])
MSZoning = pd.get_dummies(train['MSZoning'])
BsmtFinType2 = pd.get_dummies(train['BsmtFinType2'])
BsmtFinType1 = pd.get_dummies(train['BsmtFinType1'])
BsmtExposure = pd.get_dummies(train['BsmtExposure'])
BsmtCond = pd.get_dummies(train['BsmtCond'])
BsmtQual = pd.get_dummies(train['BsmtQual'])
Foundation = pd.get_dummies(train['Foundation'])
Functional = pd.get_dummies(train['Functional'])
Electrical = pd.get_dummies(train['Electrical'])
CentralAir = pd.get_dummies(train['CentralAir'])
KitchenQual = pd.get_dummies(train['KitchenQual'])
HeatingQC = pd.get_dummies(train['HeatingQC'])
Heating = pd.get_dummies(train['Heating'])
LotConfig = pd.get_dummies(train['LotConfig'])
LandSlope = pd.get_dummies(train['LandSlope'])
SaleCondition = pd.get_dummies(train['SaleCondition'])
SaleType = pd.get_dummies(train['SaleType'])
PavedDrive = pd.get_dummies(train['PavedDrive'])
GarageCond = pd.get_dummies(train['GarageCond'])
GarageQual = pd.get_dummies(train['GarageQual'])
GarageFinish = pd.get_dummies(train['GarageFinish'])
GarageType = pd.get_dummies(train['GarageType'])
Alley = pd.get_dummies(train['Alley'])
FireplaceQu = pd.get_dummies(train['FireplaceQu'])
PoolQC = pd.get_dummies(train['PoolQC'])
Fence = pd.get_dummies(train['Fence'])
MiscFeature = pd.get_dummies(train['MiscFeature'])
train = pd.concat([train, Neighborhood, MSZoning, Street, LotShape, Exterior1st, Exterior2nd, Heating, Alley, GarageQual, Utilities, Electrical, LandContour, RoofStyle, FireplaceQu, Condition2, PoolQC, Fence, MiscFeature, BldgType, Condition1, Neighborhood, ExterCond, ExterQual, MasVnrType, BsmtFinType2, BsmtFinType1, BsmtExposure, BsmtCond, BsmtQual, Foundation, Functional, CentralAir, KitchenQual, HeatingQC, GarageCond, GarageFinish, GarageType, LotConfig, LandSlope, SaleCondition, SaleType, PavedDrive], axis=1)
train.drop(['MSZoning', 'Street', 'LotShape', 'LandContour', 'Utilities', 'RoofMatl', 'RoofStyle', 'HouseStyle', 'BldgType', 'Condition2', 'Condition1', 'Neighborhood', 'ExterCond', 'ExterQual', 'MasVnrType', 'Exterior2nd', 'Exterior1st', 'BsmtFinType2', 'BsmtFinType1', 'FireplaceQu', 'PoolQC', 'Fence', 'MiscFeature', 'Alley', 'BsmtExposure', 'BsmtCond', 'BsmtQual', 'Foundation', 'Functional', 'Electrical', 'CentralAir', 'KitchenQual', 'HeatingQC', 'Heating', 'GarageCond', 'GarageQual', 'GarageFinish', 'GarageType', 'LotConfig', 'LandSlope', 'SaleCondition', 'SaleType', 'PavedDrive'], axis=1, inplace=True)
train
x = train.drop('SalePrice', axis=1)
y = train['SalePrice']
from sklearn.impute import SimpleImputer
imputer = SimpleImputer(missing_values=np.nan, strategy='median', verbose=0)
import numpy as np
import pandas as pd
import os
for (dirname, _, filenames) in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
color = sns.color_palette()
import warnings
warnings.filterwarnings('ignore')
train = pd.read_csv('_data/input/house-prices-advanced-regression-techniques/train.csv')
test = pd.read_csv('_data/input/house-prices-advanced-regression-techniques/test.csv')
train.head()
test.head()
train.shape
test.shape
train.info()
train.describe()
train_cat = train.select_dtypes(include=['object'])
test_cat = test.select_dtypes(include=['object'])
train_cat.info()
train_numeric = train.select_dtypes(include=['float64', 'int64'])
test_numeric = test.select_dtypes(include=['float64', 'int64'])
train_numeric.info()
missing_cat_train = pd.DataFrame(train_cat.isna().sum().sort_values(ascending=False), columns=['missing_cat_total'])
missing_cat_test = pd.DataFrame(test_cat.isna().sum().sort_values(ascending=False), columns=['missing_cat_total'])
print(missing_cat_train)
print('-' * 40)
print(missing_cat_test)
missing_numeric_train = pd.DataFrame(train_numeric.isna().sum().sort_values(ascending=False), columns=['missing_num_total'])
missing_numeric_test = pd.DataFrame(test_numeric.isna().sum().sort_values(ascending=False), columns=['missing_num_total'])
print(missing_numeric_train)
print('-' * 40)
print(missing_numeric_test)
missing_cat_percent = missing_cat_train['missing_cat_total'] / 1460 * 100
print(missing_cat_percent)
missing_num_percent = missing_numeric_train['missing_num_total'] / 1460 * 100
print(missing_num_percent)
train = train.drop(['PoolQC', 'MiscFeature', 'Alley', 'Fence', 'FireplaceQu'], axis=1)
train.head()
test = test.drop(['PoolQC', 'MiscFeature', 'Alley', 'Fence', 'FireplaceQu'], axis=1)
print(train.shape)
print(test.shape)
missing_data = train[['GarageType', 'GarageCond', 'GarageQual', 'GarageFinish', 'BsmtFinType2', 'BsmtExposure', 'BsmtFinType1', 'BsmtQual', 'BsmtCond', 'MasVnrType', 'Electrical', 'LotFrontage', 'GarageYrBlt', 'MasVnrArea']]
missing_data.head()
for col in ('GarageType', 'GarageCond', 'GarageQual', 'GarageFinish', 'BsmtFinType2', 'BsmtFinType1', 'BsmtExposure', 'BsmtQual', 'BsmtCond', 'MasVnrType', 'Electrical', 'MasVnrArea'):
    train[col] = train[col].fillna('None')
train['LotFrontage'] = train['LotFrontage'].fillna(train['LotFrontage'].mean())
train['GarageYrBlt'] = train['GarageYrBlt'].fillna(train['GarageYrBlt'].mean())
for col in ('GarageType', 'GarageCond', 'GarageQual', 'GarageFinish', 'BsmtFinType2', 'BsmtFinType1', 'BsmtExposure', 'BsmtQual', 'BsmtCond', 'MasVnrType', 'Electrical', 'MasVnrArea'):
    test[col] = test[col].fillna('None')
test['LotFrontage'] = test['LotFrontage'].fillna(test['LotFrontage'].mean())
test['GarageYrBlt'] = test['GarageYrBlt'].fillna(test['GarageYrBlt'].mean())
print(train.isna().sum().sort_values(ascending=False))
print('*' * 40)
print(test.isna().sum().sort_values(ascending=False))
test_missing_left = pd.DataFrame(test.isna().sum().sort_values(ascending=False), columns=['test_missing'])
test_missing_left = test_missing_left[test_missing_left['test_missing'] > 0]
test_missing_left
for col in ['MSZoning', 'BsmtHalfBath', 'BsmtFullBath', 'Functional', 'Utilities', 'Exterior1st', 'KitchenQual', 'GarageCars', 'GarageArea', 'BsmtFinSF1', 'TotalBsmtSF', 'BsmtFinSF2', 'BsmtUnfSF', 'SaleType', 'Exterior2nd']:
    test[col] = test[col].fillna('None')
print(test.isna().sum().sort_values(ascending=False))
plt.figure(figsize=(20, 1))
sns.heatmap(train.drop('Id', axis=1).corr().sort_values(by=['SalePrice'], ascending=False).head(1), cmap='coolwarm', annot=True, annot_kws={'size': 8}, fmt='.2f')
plt.title('Correlation of Numerical Features with the Target', weight='bold', fontsize=18)
plt.xticks(weight='bold')
plt.yticks(weight='bold', color='dodgerblue', rotation=0)

plt.figure(figsize=(14, 12))
sns.set(font_scale=1.5)
sns.heatmap(train.drop('Id', axis=1).corr(), mask=np.triu(np.ones_like(train.drop('Id', axis=1).corr(), dtype=np.bool)), fmt='.2f', cmap='coolwarm', annot=True, cbar_kws={'shrink': 0.8}, annot_kws={'size': 8})

plt.figure(figsize=(16, 10))
sns.set_palette('pastel')
plt.subplot(2, 3, 1)
sns.regplot(x='GrLivArea', y='SalePrice', data=train)
plt.subplot(2, 3, 2)
sns.boxplot(x='OverallQual', y='SalePrice', data=train)
plt.subplot(2, 3, 3)
sns.regplot(x='TotalBsmtSF', y='SalePrice', data=train)
plt.subplot(2, 3, 4)
sns.regplot(x='1stFlrSF', y='SalePrice', data=train)
plt.subplot(2, 3, 5)
sns.boxplot(x='GarageCars', y='SalePrice', data=train)
plt.subplot(2, 3, 6)
sns.regplot(x='GarageArea', y='SalePrice', data=train)
plt.subplots_adjust(wspace=0.5)

traincat = train.select_dtypes(include=['object'])
traincat.columns
plt.figure(figsize=(20, 35))
sns.set_palette('pastel')
sns.set_style('darkgrid')
plt.subplot(8, 5, 1)
sns.violinplot(x='MSZoning', y='SalePrice', data=train)
plt.subplot(8, 5, 2)
sns.violinplot(x='Street', y='SalePrice', data=train)
plt.subplot(8, 5, 3)
sns.violinplot(x='LotShape', y='SalePrice', data=train)
plt.subplot(8, 5, 4)
sns.violinplot(x='LandContour', y='SalePrice', data=train)
plt.subplot(8, 5, 5)
sns.violinplot(x='Utilities', y='SalePrice', data=train)
plt.subplot(8, 5, 6)
sns.violinplot(x='LotConfig', y='SalePrice', data=train)
plt.subplot(8, 5, 7)
sns.violinplot(x='LandSlope', y='SalePrice', data=train)
plt.subplot(8, 5, 8)
sns.violinplot(x='Neighborhood', y='SalePrice', data=train)
plt.subplot(8, 5, 9)
sns.violinplot(x='Condition1', y='SalePrice', data=train)
plt.subplot(8, 5, 10)
sns.violinplot(x='Condition2', y='SalePrice', data=train)
plt.subplot(8, 5, 11)
sns.violinplot(x='BldgType', y='SalePrice', data=train)
plt.subplot(8, 5, 12)
sns.violinplot(x='HouseStyle', y='SalePrice', data=train)
plt.subplot(8, 5, 13)
sns.violinplot(x='RoofStyle', y='SalePrice', data=train)
plt.subplot(8, 5, 14)
sns.violinplot(x='RoofMatl', y='SalePrice', data=train)
plt.subplot(8, 5, 15)
sns.violinplot(x='Exterior1st', y='SalePrice', data=train)
plt.subplot(8, 5, 16)
sns.violinplot(x='Exterior2nd', y='SalePrice', data=train)
plt.subplot(8, 5, 17)
sns.violinplot(x='MasVnrType', y='SalePrice', data=train)
plt.subplot(8, 5, 18)
sns.violinplot(x='MasVnrArea', y='SalePrice', data=train)
plt.subplot(8, 5, 19)
sns.violinplot(x='ExterQual', y='SalePrice', data=train)
plt.subplot(8, 5, 20)
sns.violinplot(x='ExterCond', y='SalePrice', data=train)
plt.subplot(8, 5, 21)
sns.violinplot(x='Foundation', y='SalePrice', data=train)
plt.subplot(8, 5, 22)
sns.violinplot(x='BsmtQual', y='SalePrice', data=train)
plt.subplot(8, 5, 23)
sns.violinplot(x='BsmtCond', y='SalePrice', data=train)
plt.subplot(8, 5, 24)
sns.violinplot(x='BsmtExposure', y='SalePrice', data=train)
plt.subplot(8, 5, 25)
sns.violinplot(x='BsmtFinType1', y='SalePrice', data=train)
plt.subplot(8, 5, 26)
sns.violinplot(x='BsmtFinType2', y='SalePrice', data=train)
plt.subplot(8, 5, 27)
sns.violinplot(x='Heating', y='SalePrice', data=train)
plt.subplot(8, 5, 28)
sns.violinplot(x='HeatingQC', y='SalePrice', data=train)
plt.subplot(8, 5, 29)
sns.violinplot(x='CentralAir', y='SalePrice', data=train)
plt.subplot(8, 5, 30)
sns.violinplot(x='Electrical', y='SalePrice', data=train)
plt.subplot(8, 5, 31)
sns.violinplot(x='KitchenQual', y='SalePrice', data=train)
plt.subplot(8, 5, 32)
sns.violinplot(x='Functional', y='SalePrice', data=train)
plt.subplot(8, 5, 33)
sns.violinplot(x='GarageType', y='SalePrice', data=train)
plt.subplot(8, 5, 34)
sns.violinplot(x='GarageFinish', y='SalePrice', data=train)
plt.subplot(8, 5, 35)
sns.violinplot(x='GarageQual', y='SalePrice', data=train)
plt.subplot(8, 5, 35)
sns.violinplot(x='GarageCond', y='SalePrice', data=train)
plt.subplot(8, 5, 36)
sns.violinplot(x='PavedDrive', y='SalePrice', data=train)
plt.subplot(8, 5, 37)
sns.violinplot(x='SaleType', y='SalePrice', data=train)
plt.subplot(8, 5, 38)
sns.violinplot(x='SaleCondition', y='SalePrice', data=train)
plt.subplots_adjust(wspace=0.5, hspace=0.8)

features = ['OverallQual', 'YearBuilt', 'YearRemodAdd', 'TotalBsmtSF', '1stFlrSF', 'GrLivArea', 'FullBath', 'TotRmsAbvGrd', 'Fireplaces', 'GarageYrBlt', 'GarageCars', 'GarageArea', 'MSZoning', 'Neighborhood', 'Condition1', 'Condition2', 'RoofMatl', 'ExterQual', 'BsmtQual', 'CentralAir', 'KitchenQual', 'SaleType', 'MasVnrType', 'SaleCondition', 'HouseStyle']
traintest = pd.concat([train, test], axis=0, sort=False)
traintest.head()
traintest.tail()
traintest.shape
train_test = pd.get_dummies(traintest[features])
train_test.head()
X_train = train_test[0:1460]
X_test = train_test[1460:2919]
y_train = train[['SalePrice']]
print('Train', X_train.shape)
print('Test', X_test.shape)
from sklearn.linear_model import LinearRegression
lr = LinearRegression()
from sklearn.impute import SimpleImputer
my_imputer = SimpleImputer()
X_train = my_imputer.fit_transform(X_train)
X_test = my_imputer.fit_transform(X_test)
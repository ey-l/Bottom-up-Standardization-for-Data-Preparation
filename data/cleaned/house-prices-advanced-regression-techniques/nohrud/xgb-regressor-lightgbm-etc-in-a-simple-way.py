import os
for (dirname, _, filenames) in os.walk('/kaggle/input'):
    for filename in filenames:
        print(os.path.join(dirname, filename))
from sklearn.ensemble import RandomForestRegressor
import xgboost as xgb
import lightgbm as lgb
import pandas as pd
import numpy as np
from sklearn.preprocessing import LabelEncoder
from sklearn.metrics import r2_score
import warnings
warnings.simplefilter('ignore')
df = pd.read_csv('_data/input/house-prices-advanced-regression-techniques/train.csv')
test_data = pd.read_csv('_data/input/house-prices-advanced-regression-techniques/test.csv')
df
le = LabelEncoder()
df['MSZoning'] = le.fit_transform(df['MSZoning'])
df['Street'] = le.fit_transform(df['Street'])
df['LotShape'] = le.fit_transform(df['LotShape'])
df['LandContour'] = le.fit_transform(df['LandContour'])
df['Utilities'] = le.fit_transform(df['Utilities'])
df['PoolQC'] = le.fit_transform(df['PoolQC'])
df['Fence'] = le.fit_transform(df['Fence'])
df['MiscFeature'] = le.fit_transform(df['MiscFeature'])
df['SaleType'] = le.fit_transform(df['SaleType'])
df['SaleCondition'] = le.fit_transform(df['SaleCondition'])
df['MSZoning'] = le.fit_transform(df['MSZoning'])
df['Street'] = le.fit_transform(df['Street'])
df['Alley'] = le.fit_transform(df['Alley'])
df['LotShape'] = le.fit_transform(df['LotShape'])
df['LotConfig'] = le.fit_transform(df['LotConfig'])
df['LandSlope'] = le.fit_transform(df['LandSlope'])
df['Neighborhood'] = le.fit_transform(df['Neighborhood'])
df['Condition1'] = le.fit_transform(df['Condition1'])
df['Condition2'] = le.fit_transform(df['Condition2'])
df['BldgType'] = le.fit_transform(df['BldgType'])
df['HouseStyle'] = le.fit_transform(df['HouseStyle'])
df['OverallQual'] = le.fit_transform(df['OverallQual'])
df['RoofStyle'] = le.fit_transform(df['RoofStyle'])
df['RoofMatl'] = le.fit_transform(df['RoofMatl'])
df['Exterior1st'] = le.fit_transform(df['Exterior1st'])
df['Exterior2nd'] = le.fit_transform(df['Exterior2nd'])
df[['MasVnrType']].astype(str)
df['MasVnrType'] = le.fit_transform(df['MasVnrType'])
df['ExterQual'] = le.fit_transform(df['ExterQual'])
df['ExterCond'] = le.fit_transform(df['ExterCond'])
df['Foundation'] = le.fit_transform(df['Foundation'])
df['BsmtQual'] = le.fit_transform(df['BsmtQual'])
df['BsmtCond'] = le.fit_transform(df['BsmtCond'])
df['BsmtExposure'] = le.fit_transform(df['BsmtExposure'])
df['PavedDrive'] = le.fit_transform(df['PavedDrive'])
df['BsmtFinType1'] = le.fit_transform(df['BsmtFinType1'])
df['GarageFinish'] = le.fit_transform(df['GarageFinish'])
df['Functional'] = le.fit_transform(df['Functional'])
df['KitchenQual'] = le.fit_transform(df['KitchenQual'])
df['GarageQual'] = le.fit_transform(df['GarageQual'])
df['GarageCond'] = le.fit_transform(df['GarageCond'])
df['BsmtCond'] = le.fit_transform(df['BsmtCond'])
df['BsmtFinType1'] = le.fit_transform(df['BsmtFinType1'])
df['BsmtFinType2'] = le.fit_transform(df['BsmtFinType2'])
df['Heating'] = le.fit_transform(df['Heating'])
df['BsmtQual'] = le.fit_transform(df['BsmtQual'])
df['Electrical'] = le.fit_transform(df['Electrical'])
df['HeatingQC'] = le.fit_transform(df['HeatingQC'])
df['GarageFinish'] = le.fit_transform(df['GarageFinish'])
df['GarageType'] = le.fit_transform(df['GarageType'])
df['CentralAir'] = le.fit_transform(df['CentralAir'])
df['FireplaceQu'] = le.fit_transform(df['FireplaceQu'])
test_data['MSZoning'] = le.fit_transform(test_data['MSZoning'])
test_data['Street'] = le.fit_transform(test_data['Street'])
test_data['LotShape'] = le.fit_transform(test_data['LotShape'])
test_data['LandContour'] = le.fit_transform(test_data['LandContour'])
test_data['Utilities'] = le.fit_transform(test_data['Utilities'])
test_data['PoolQC'] = le.fit_transform(test_data['PoolQC'])
test_data['Fence'] = le.fit_transform(test_data['Fence'])
test_data['MiscFeature'] = le.fit_transform(test_data['MiscFeature'])
test_data['SaleType'] = le.fit_transform(test_data['SaleType'])
test_data['SaleCondition'] = le.fit_transform(test_data['SaleCondition'])
test_data['MSZoning'] = le.fit_transform(test_data['MSZoning'])
test_data['Street'] = le.fit_transform(test_data['Street'])
test_data['Alley'] = le.fit_transform(test_data['Alley'])
test_data['LotShape'] = le.fit_transform(test_data['LotShape'])
test_data['LotConfig'] = le.fit_transform(test_data['LotConfig'])
test_data['LandSlope'] = le.fit_transform(test_data['LandSlope'])
test_data['Neighborhood'] = le.fit_transform(test_data['Neighborhood'])
test_data['Condition1'] = le.fit_transform(test_data['Condition1'])
test_data['Condition2'] = le.fit_transform(test_data['Condition2'])
test_data['BldgType'] = le.fit_transform(test_data['BldgType'])
test_data['HouseStyle'] = le.fit_transform(test_data['HouseStyle'])
test_data['OverallQual'] = le.fit_transform(test_data['OverallQual'])
test_data['RoofStyle'] = le.fit_transform(test_data['RoofStyle'])
test_data['RoofMatl'] = le.fit_transform(test_data['RoofMatl'])
test_data['Exterior1st'] = le.fit_transform(test_data['Exterior1st'])
test_data['Exterior2nd'] = le.fit_transform(test_data['Exterior2nd'])
test_data[['MasVnrType']].astype(str)
test_data['MasVnrType'] = le.fit_transform(test_data['MasVnrType'])
test_data['ExterQual'] = le.fit_transform(test_data['ExterQual'])
test_data['ExterCond'] = le.fit_transform(test_data['ExterCond'])
test_data['Foundation'] = le.fit_transform(test_data['Foundation'])
test_data['BsmtQual'] = le.fit_transform(test_data['BsmtQual'])
test_data['BsmtCond'] = le.fit_transform(test_data['BsmtCond'])
test_data['BsmtExposure'] = le.fit_transform(test_data['BsmtExposure'])
test_data['PavedDrive'] = le.fit_transform(test_data['PavedDrive'])
test_data['BsmtFinType1'] = le.fit_transform(test_data['BsmtFinType1'])
test_data['GarageFinish'] = le.fit_transform(test_data['GarageFinish'])
test_data['Functional'] = le.fit_transform(test_data['Functional'])
test_data['KitchenQual'] = le.fit_transform(test_data['KitchenQual'])
test_data['GarageQual'] = le.fit_transform(test_data['GarageQual'])
test_data['GarageCond'] = le.fit_transform(test_data['GarageCond'])
test_data['BsmtCond'] = le.fit_transform(test_data['BsmtCond'])
test_data['BsmtFinType1'] = le.fit_transform(test_data['BsmtFinType1'])
test_data['BsmtFinType2'] = le.fit_transform(test_data['BsmtFinType2'])
test_data['Heating'] = le.fit_transform(test_data['Heating'])
test_data['BsmtQual'] = le.fit_transform(test_data['BsmtQual'])
test_data['Electrical'] = le.fit_transform(test_data['Electrical'])
test_data['HeatingQC'] = le.fit_transform(test_data['HeatingQC'])
test_data['GarageFinish'] = le.fit_transform(test_data['GarageFinish'])
test_data['GarageType'] = le.fit_transform(test_data['GarageType'])
test_data['CentralAir'] = le.fit_transform(test_data['CentralAir'])
test_data['FireplaceQu'] = le.fit_transform(test_data['FireplaceQu'])
df = df.fillna(df.mean())
df
df.corr()
x_train_p = df.iloc[0:, 1:80]
y_train_p = df.iloc[0:, -1]
x_train = x_train_p.to_numpy()
y_train = y_train_p.to_numpy()
x_test_p = test_data.iloc[0:, 1:]
x_test = x_test_p.to_numpy()
x_train_p
xgbm = xgb.XGBRegressor(max_depth=10)